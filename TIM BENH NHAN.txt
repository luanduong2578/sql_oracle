
-- TIM BENH NHAN
SELECT
    HS.HSBA_SOVAOVIEN,
    BN.BENHNHAN_MA, 
    BN.BENHNHAN_HOTEN, 
    BN.BENHNHAN_NAMSINH,
    (SELECT T.DMTINH_TEN FROM DM_TINH T WHERE T.DMTINH_MASO = BN.TINH_MA) TINH,
    (SELECT H.DMHUYEN_TEN FROM DM_HUYEN H WHERE H.DMHUYEN_MASO = BN.HUYEN_MA) HUYEN,
    (SELECT X.DMXA_TEN FROM DM_XA X WHERE X.DMXA_MASO = BN.XA_MA) XA,
    TO_CHAR(HS.HSBA_NGAYGIOVAOV, 'dd/MM/yyyy hh24:mi')NGAY_VAO,
    TO_CHAR(HS.HSBA_NGAYGIORAV, 'dd/MM/yyyy hh24:mi')NGAY_RA,
    (SELECT K.DMKHOA_TEN FROM DM_KHOA K WHERE HS.HSBA_KHOADANGDT=K.DMKHOA_MASO) KHOA,
    (SELECT ICD.DMBENHICD_MA FROM DM_BENH_ICD ICD WHERE HS.HSBA_MACHDRAVIEN= ICD.DMBENHICD_MASO) ICD,
    (SELECT ICD.DMBENHICD_TEN FROM DM_BENH_ICD ICD WHERE HS.HSBA_MACHDRAVIEN= ICD.DMBENHICD_MASO) ICDTEN
FROM HSBA HS 
  INNER JOIN BENH_NHAN BN ON HS.BENHNHAN_MA = BN.BENHNHAN_MA 
where bn.benhnhan_hoten ='NGUY?N TH? TIÊN'AND BENHNHAN_NAMSINH = 1993;